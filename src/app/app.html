<div class="app-layout">
  <!-- Top Header -->
  <header class="navbar">
    <div class="brand" (click)="confirmLogout()" style="cursor: pointer;" title="Logout">
      <h1>MEAN App</h1>
    </div>

    <div class="right-section">
      <div class="server-selector">
        <label for="server-select">Server:</label>
        <select id="server-select" [ngModel]="apiService.mode()" (ngModelChange)="onServerChange($event)">
          <option value="REST">REST API</option>
          <option value="GRAPHQL">GraphQL API</option>
        </select>
      </div>

      <button (click)="themeService.toggleTheme()" class="theme-toggle"
        [attr.aria-label]="'Switch to ' + (themeService.currentTheme() === 'dark' ? 'light' : 'dark') + ' mode'">
        {{ themeService.currentTheme() === 'dark' ? '‚òÄÔ∏è' : 'üåô' }}
      </button>

      <div class="user-menu-container">
        <button class="user-btn" (click)="toggleUserMenu()" aria-label="User Menu">
          üë§
        </button>

        <div class="user-dropdown" *ngIf="isUserMenuOpen()">
          <ng-container *ngIf="!authService.isAuthenticated()">
            <a routerLink="/login" (click)="closeUserMenu()" class="dropdown-item">Login</a>
            <a routerLink="/register" (click)="closeUserMenu()" class="dropdown-item">Register</a>
          </ng-container>

          <ng-container *ngIf="authService.isAuthenticated()">
            <div class="dropdown-header">Welcome!</div>
            <button (click)="logout()" class="dropdown-item logout-link">Logout</button>
          </ng-container>
        </div>
      </div>
    </div>
  </header>

  <div class="content-wrapper">
    <!-- Side Navigation (Only if Logged In) -->
    <aside class="sidenav" *ngIf="authService.isAuthenticated()">
      <nav>
        <a routerLink="/products" routerLinkActive="active" class="nav-item">
          üì¶ Products
        </a>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <router-outlet></router-outlet>
    </main>
  </div>

  <app-confirm-dialog></app-confirm-dialog>
</div>